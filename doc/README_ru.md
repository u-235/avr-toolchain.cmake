[EN]

----------------

# avr-gcc-toolchain.cmake

Набор для сборки ПО для микроконтроллеров AVR при помощи CMake и утилит AVR GCC.

- [Обзор](#обзор)
- [Что потребуется](#что-потребуется)
- [Поехали](#поехали)
- [Примеры](#примеры)
- [Лицензии](#лицензии)

## Обзор

- Легкий старт. Всего несколько новых команд с интуитивно понятными опциями.
- Возможность создавать библиотеки.

Нет и пока не планируется поддержка загрузки прошивки в микроконтроллер.


## Что потребуется

CMake не ниже 10 версии. Однако для использования файла предустановок CMakePresets.json требуется версия 20 и выше.


## Поехали

Это просто:

- Скопируйте папку `cmake` в удобное вам место, например в корень вашего проекта.
- В главном `CMakeLists.txt` добавьте команды `find_package` и `avr_configure_mcu` с необходимыми параметрами, примерно так:

  ```cmake
  cmake_minimum_required(VERSION 3.10)
  project(nixie LANGUAGES C CXX)
  find_package(AVR REQUIRED binutils libc)
  avr_configure_mcu(
          atmega168
          NAME         MY_MCU
          DEFINES      F_CPU=16000000UL
          OPTIONS      -Os -ffunction-sections -fdata-sections
          LINK_OPTIONS -Wl,--gc-sections
  )
  ```

- При помощи `target_link_libraries` добавьте цель `MY_MCU` ко всем целям, которые содержат код для микроконтроллера.
- При вызове `cmake` для конфигурирования проекта добавьте опцию `-DCMAKE_TOOLCHAIN_FILE=path/to/avr-gcc-toolchain.cmake`.

Подробности смотрите в [документации][doc].


## Примеры

В качестве примера посмотрите использование этого набора в проекте [nixie-in18].


## Лицензии

Исходный код скриптов CMake распространяется под лицензией МИТ. Лицензирование примеров смотрите в соответствующей документации.


[EN]: ../README.md
[doc]: USAGE_ru.md "Как использовать"

[nixie-in18]: https://github.com/u-235/nixie-in18
